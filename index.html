<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bani Nur</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Select2 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

  <!-- DataTables CSS -->
  <link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />

  <!-- FontAwesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
</head>

<body>
  <div class="container mt-3">
    <div class="row">
      <div class="col-12 text-center">
        <h5>Keturunan dari<br />Mbah H. Nur & Mbah Genuk</h5>
      </div>
    </div>
    <hr />

    <div class="row">
      <div class="col-12" id="table-anak">
        <table class="table table-bordered">
          <thead style="text-align: center">
            <th>No</th>
            <th>Anak</th>
            <th>Pasangan</th>
            <th>Info</th>
          </thead>
          <tbody id="data-table-anak">
            <!-- Rows will be dynamically inserted here -->
          </tbody>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-12" id="table-judul-anak" style="display: none;">
        <table class="table table-bordered">
          <thead style="text-align: center;">
            <th>Pasangan Anak</th>
            <th style="width: 1%;">Kembali</th>
          </thead>
          <tbody>
            <tr>
              <td>
                <span id="value-judul-anak"></span>
                &
                <span id="value-judul-pasangan-anak"></span>
              </td>
              <td style="text-align: center;">
                <button class="btn btn-danger btn-sm" onclick="backtableanak()"><i
                    class="fa-solid fa-circle-up"></i></button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-12" id="table-judul-putu" style="display: none;">
        <table class="table table-bordered">
          <thead style="text-align: center;">
            <th>Pasangan Putu</th>
            <th style="width: 1%;">Kembali</th>
          </thead>
          <tbody>
            <tr>
              <td>
                <span id="value-judul-putu"></span>
                &
                <span id="value-judul-pasangan-putu"></span>
              </td>
              <td style="text-align: center;">
                <button class="btn btn-danger btn-sm" onclick="backtableputu()"><i
                    class="fa-solid fa-circle-up"></i></button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-12" id="table-judul-buyut" style="display: none;">
        <table class="table table-bordered">
          <thead style="text-align: center;">
            <th>Pasangan Buyut</th>
            <th style="width: 1%;">Kembali</th>
          </thead>
          <tbody>
            <tr>
              <td>
                <span id="value-judul-buyut"></span>
                &
                <span id="value-judul-pasangan-buyut"></span>
              </td>
              <td style="text-align: center;">
                <button class="btn btn-danger btn-sm" onclick="backtablebuyut()"><i
                    class="fa-solid fa-circle-up"></i></button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-12" id="table-putu" style="display: none;">
        <table class="table table-bordered">
          <thead style="text-align: center;">
            <th>No</th>
            <th>Nama</th>
            <th>Pasangan</th>
            <th>Info</th>
          </thead>
          <tbody id="data-table-putu">

          </tbody>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-12" id="table-buyut" style="display: none;">
        <table class="table table-bordered">
          <thead style="text-align: center;">
            <th>No</th>
            <th>Nama</th>
            <th>Pasangan</th>
            <th>Info</th>
          </thead>
          <tbody id="data-table-buyut">

          </tbody>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-12" id="table-canggah" style="display: none;">
        <table class="table table-bordered">
          <thead style="text-align: center;">
            <th>No</th>
            <th>Nama</th>
            <th>Pasangan</th>
            <th>Info</th>
          </thead>
          <tbody id="data-table-canggah">

          </tbody>
        </table>
      </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="modal-detail-info" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog ">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5">Info - <span id="judul-anak"></span></h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-12">
                <table>
                  <tr>
                    <td>Nama Lengkap</td>
                    <td>:</td>
                    <th id="fullname"></th>
                  </tr>
                  <tr>
                    <td>Nama Panggilan</td>
                    <td>:</td>
                    <th id="nickname"></th>
                  </tr>
                  <tr>
                    <td>Bapak</td>
                    <td>:</td>
                    <th id="father"></th>
                  </tr>
                  <tr>
                    <td>Ibu</td>
                    <td>:</td>
                    <th id="mother"></th>
                  </tr>
                  <tr>
                    <td>Anak ke</td>
                    <td>:</td>
                    <th id="seq"></th>
                  </tr>
                  <tr>
                    <td>Jenis kelamin</td>
                    <td>:</td>
                    <th id="gender"></th>
                  </tr>
                  <tr>
                    <td>Tahun lahir</td>
                    <td>:</td>
                    <th id="born"></th>
                  </tr>
                  <tr>
                    <td>Tahun wafat</td>
                    <td>:</td>
                    <th id="dead"></th>
                  </tr>
                  <tr>
                    <td colspan="3" style="height: 30px;"> </td>
                  </tr>
                  <tr>
                    <td>Pasangan</td>
                    <td>:</td>
                    <th id="partner"></th>
                  </tr>
                  <tr>
                    <td>Tahun lahir</td>
                    <td>:</td>
                    <th id="partnerborn"></th>
                  </tr>
                  <tr>
                    <td>Tahun wafat</td>
                    <td>:</td>
                    <th id="partnerdead"></th>
                  </tr>
                  <tr>
                    <td>Jumlah anak</td>
                    <td>:</td>
                    <td id="child"></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
              Close
            </button>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Select2 JS -->
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

  <!-- DataTables JS -->
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>

  <!-- SweetAlert2 JS -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- FontAwesome (already loaded via the CSS link) -->

  <!-- Include the dataAnak.js file -->
  <script src="listdata.js"></script>

  <script>
    $(document).ready(function () {
      // Call the function when the page loads
      opentableanak();
    });

    // Function to populate table anak
    function opentableanak() {
      const $tableBody = $('#data-table-anak'); // Select table body

      $.each(anakData, function (index, anak) {
        var descendants = 0;
        // Check if anakData has corresponding putu in putuData
        const hasDescendants = putuData.some(a => a.root === anak.id);
        if (hasDescendants) {
          descendants = 1;
        } else {
          descendants = 0;
        }

        // Create table row using jQuery
        const $row = $('<tr></tr>');

        // Append sequence number (seq)
        $row.append(`<td style="text-align: center">${anak.seq}</td>`);

        // Append fullname
        $row.append(`<td>${anak.fullname}</td>`);

        // Append nickname
        $row.append(`<td>${anak.partner}</td>`);

        if (descendants == 1) {
          // Append action buttons
          const $actionButtons = `
                              <td style="text-align: center">
                                <div class="row">
                                    <div class="col-12 mb-3">
                                      <button class="btn btn-sm btn-primary" onclick="openmodalanak(${anak.id})">
                                        <i class="fa-solid fa-magnifying-glass"></i>
                                      </button>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-12">
                                      <button class="btn btn-sm btn-success" onclick="opentableputu(${anak.id},'${anak.fullname}','${anak.partner}')">
                                        <i class="fa-solid fa-child"></i>
                                      </button>
                                    </div>
                                  </div>
                              </td>
                            `;
          $row.append($actionButtons);
        } else {
          // Append action buttons
          const $actionButtons = `
                              <td style="text-align: center">
                                <div class="row">
                                    <div class="col-12 mb-3">
                                      <button class="btn btn-sm btn-primary" onclick="openmodalanak(${anak.id})">
                                        <i class="fa-solid fa-magnifying-glass"></i>
                                      </button>
                                    </div>
                                  </div>
                              </td>
                            `;
          $row.append($actionButtons);
        }

        // Append the row to the table body
        $tableBody.append($row);
      });

    }

    // function to open table putu
    function opentableputu(id, anakname, partner) {
      const $tableBody = $('#data-table-putu'); // Select table body

      // Clear the table body before appending new data
      $tableBody.empty();

      // Find all data from putuData array based on the root
      const putuList = putuData.filter(a => a.root === id);

      $.each(putuList, function (index, putu) {
        var descendants = 0;
        // Check if anakData has corresponding putu in putuData
        const hasDescendants = buyutData.some(a => a.root === putu.id);
        if (hasDescendants) {
          descendants = 1;
        } else {
          descendants = 0;
        }

        // Create table row using jQuery
        const $row = $('<tr></tr>');

        // Append sequence number (seq)
        $row.append(`<td style="text-align: center">${putu.seq}</td>`);

        // Append fullname
        $row.append(`<td>${putu.fullname}</td>`);

        // Append partner's name
        $row.append(`<td>${putu.partner}</td>`);

        if (descendants == 1) {
          // Append action buttons
          const $actionButtons = `
                              <td style="text-align: center">
                                <div class="row">
                                  <div class="col-12 mb-3">
                                    <button class="btn btn-sm btn-primary" onclick="openmodalputu(${putu.id})">
                                      <i class="fa-solid fa-magnifying-glass"></i>
                                    </button>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-12">
                                    <button class="btn btn-sm btn-success" onclick="opentablebuyut(${putu.id},'${putu.fullname}','${putu.partner}')">
                                      <i class="fa-solid fa-child"></i>
                                    </button>
                                  </div>
                                </div>
                              </td>
                            `;
          $row.append($actionButtons);
        } else {
          // Append action buttons
          const $actionButtons = `
                              <td style="text-align: center">
                                <div class="row">
                                  <div class="col-12 mb-3">
                                    <button class="btn btn-sm btn-primary" onclick="openmodalputu(${putu.id})">
                                      <i class="fa-solid fa-magnifying-glass"></i>
                                    </button>
                                  </div>
                                </div>
                              </td>
                            `;
          $row.append($actionButtons);
        }


        // Append the row to the table body
        $tableBody.append($row);
      });

      // Update the title and other elements
      $('#value-judul-anak').html(anakname);
      $('#value-judul-pasangan-anak').html(partner);

      // Hide and show relevant sections
      $('#table-anak').hide();
      $('#table-judul-anak').show();
      $('#table-putu').show();
    }

    // function to open table buyut
    function opentablebuyut(id, putuname, partner) {
      const $tableBody = $('#data-table-buyut'); // Select table body

      // Clear the table body before appending new data
      $tableBody.empty();

      // Find all data from buyutData array based on the root
      const buyutList = buyutData.filter(a => a.root === id);

      $.each(buyutList, function (index, buyut) {
        var descendants = 0;
        // Check if anakData has corresponding putu in putuData
        const hasDescendants = canggahData.some(a => a.root === buyut.id);
        if (hasDescendants) {
          descendants = 1;
        } else {
          descendants = 0;
        }
        // Create table row using jQuery
        const $row = $('<tr></tr>');

        // Append sequence number (seq)
        $row.append(`<td style="text-align: center">${buyut.seq}</td>`);

        // Append fullname
        $row.append(`<td>${buyut.fullname}</td>`);

        // Append partner's name
        $row.append(`<td>${buyut.partner}</td>`);

        if (descendants == 1) {
          // Append action buttons
          const $actionButtons = `
                            <td style="text-align: center">
                              <div class="row">
                                <div class="col-12 mb-3">
                                  <button class="btn btn-sm btn-primary" onclick="openmodalbuyut(${buyut.id})">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                  </button>
                                </div>
                              </div>
                              <div class="row">
                                <div class="col-12">
                                  <button class="btn btn-sm btn-success" onclick="opentablecanggah(${buyut.id},'${buyut.fullname}','${buyut.partner}')">
                                    <i class="fa-solid fa-child"></i>
                                  </button>
                                </div>
                              </div>
                            </td>
                          `;
          $row.append($actionButtons);
        } else {
          // Append action buttons
          const $actionButtons = `
                            <td style="text-align: center">
                              <div class="row">
                                <div class="col-12 mb-3">
                                  <button class="btn btn-sm btn-primary" onclick="openmodalbuyut(${buyut.id})">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                  </button>
                                </div>
                              </div>
                            </td>
                          `;
          $row.append($actionButtons);
        }

        // Append the row to the table body
        $tableBody.append($row);
      });

      // Update the title and other elements
      $('#value-judul-putu').html(putuname);
      $('#value-judul-pasangan-putu').html(partner);

      // Hide and show relevant sections
      $('#table-anak').hide();
      $('#table-putu').hide();
      $('#table-judul-anak').show();
      $('#table-judul-putu').show();
      $('#table-buyut').show();
    }

    // function to open table buyut
    function opentablecanggah(id, buyutname, partner) {
      const $tableBody = $('#data-table-canggah'); // Select table body

      // Clear the table body before appending new data
      $tableBody.empty();

      // Find all data from buyutData array based on the root
      const canggahList = canggahData.filter(a => a.root === id);

      $.each(canggahList, function (index, canggah) {
        var descendants = 0;
        // Check if anakData has corresponding putu in putuData
        const hasDescendants = warengData.some(a => a.root === canggah.id);
        if (hasDescendants) {
          descendants = 1;
        } else {
          descendants = 0;
        }
        // Create table row using jQuery
        const $row = $('<tr></tr>');

        // Append sequence number (seq)
        $row.append(`<td style="text-align: center">${canggah.seq}</td>`);

        // Append fullname
        $row.append(`<td>${canggah.fullname}</td>`);

        // Append partner's name
        $row.append(`<td>${canggah.partner}</td>`);

        if (descendants == 1) {
          // Append action buttons
          const $actionButtons = `
                            <td style="text-align: center">
                              <div class="row">
                                <div class="col-12 mb-3">
                                  <button class="btn btn-sm btn-primary" onclick="openmodalcanggah(${canggah.id})">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                  </button>
                                </div>
                              </div>
                              <div class="row">
                                <div class="col-12">
                                  <button class="btn btn-sm btn-success" onclick="opentablewareng(${canggah.id},'${canggah.fullname}','${canggah.partner}')">
                                    <i class="fa-solid fa-child"></i>
                                  </button>
                                </div>
                              </div>
                            </td>
                          `;
          $row.append($actionButtons);
        } else {
          // Append action buttons
          const $actionButtons = `
                            <td style="text-align: center">
                              <div class="row">
                                <div class="col-12 mb-3">
                                  <button class="btn btn-sm btn-primary" onclick="openmodalcanggah(${canggah.id})">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                  </button>
                                </div>
                              </div>
                            </td>
                          `;
          $row.append($actionButtons);
        }


        // Append the row to the table body
        $tableBody.append($row);
      });

      // Update the title and other elements
      $('#value-judul-buyut').html(buyutname);
      $('#value-judul-pasangan-buyut').html(partner);

      // Hide and show relevant sections
      $('#table-anak').hide();
      $('#table-putu').hide();
      $('#table-buyut').hide();
      $('#table-judul-anak').show();
      $('#table-judul-putu').show();
      $('#table-judul-buyut').show();
      $('#table-canggah').show();
    }

    // function to open modal
    function openmodalanak(id) {
      // Find the data from anakData array based on the id
      const anak = anakData.find(a => a.id === id);

      $('#judul-anak').html(anak.fullname);
      $('#fullname').html(anak.fullname);
      $('#nickname').html(anak.nickname);
      $('#father').html(anak.father);
      $('#mother').html(anak.mother);
      $('#seq').html(anak.seq);
      $('#gender').html(anak.gender);
      $('#born').html(anak.born);
      $('#dead').html(anak.dead);

      $('#partner').html(anak.partner);
      $('#partnerborn').html(anak.partnerborn);
      $('#partnerdead').html(anak.partnerdead);
      $('#child').html(anak.child);

      $("#modal-detail-info").modal("show");
    }

    // function to open modal
    function openmodalputu(id) {
      // Find the data from anakData array based on the id
      const anak = putuData.find(a => a.id === id);

      // cari mama dan papa nya
      var rootorangtua = anak.root;
      var mama, papa;
      const orangtua = anakData.find(b => b.id === rootorangtua);

      // cek untuk menentukan mana papa dan mama nya
      if (orangtua.gender == 'Perempuan') {
        mama = orangtua.fullname;
        papa = orangtua.partner;
      } else {
        mama = orangtua.partner;
        papa = orangtua.fullname;
      }

      $('#judul-anak').html(anak.fullname);
      $('#fullname').html(anak.fullname);
      $('#nickname').html(anak.nickname);
      $('#father').html(papa);
      $('#mother').html(mama);
      $('#seq').html(anak.seq);
      $('#gender').html(anak.gender);
      $('#born').html(anak.born);
      $('#dead').html(anak.dead);

      $('#partner').html(anak.partner);
      $('#partnerborn').html(anak.partnerborn);
      $('#partnerdead').html(anak.partnerdead);
      $('#child').html(anak.child);

      $("#modal-detail-info").modal("show");
    }

    // function to open modal
    function openmodalbuyut(id) {
      // Find the data from anakData array based on the id
      const anak = buyutData.find(a => a.id === id);

      // cari mama dan papa nya
      var rootorangtua = anak.root;
      var mama, papa;
      const orangtua = putuData.find(b => b.id === rootorangtua);

      // cek untuk menentukan mana papa dan mama nya
      if (orangtua.gender == 'Perempuan') {
        mama = orangtua.fullname;
        papa = orangtua.partner;
      } else {
        mama = orangtua.partner;
        papa = orangtua.fullname;
      }

      $('#judul-anak').html(anak.fullname);
      $('#fullname').html(anak.fullname);
      $('#nickname').html(anak.nickname);
      $('#father').html(papa);
      $('#mother').html(mama);
      $('#seq').html(anak.seq);
      $('#gender').html(anak.gender);
      $('#born').html(anak.born);
      $('#dead').html(anak.dead);

      $('#partner').html(anak.partner);
      $('#partnerborn').html(anak.partnerborn);
      $('#partnerdead').html(anak.partnerdead);
      $('#child').html(anak.child);

      $("#modal-detail-info").modal("show");
    }

    // function to open modal
    function openmodalcanggah(id) {
      // Find the data from anakData array based on the id
      const anak = canggahData.find(a => a.id === id);

      // cari mama dan papa nya
      var rootorangtua = anak.root;
      var mama, papa;
      const orangtua = buyutData.find(b => b.id === rootorangtua);

      // cek untuk menentukan mana papa dan mama nya
      if (orangtua.gender == 'Perempuan') {
        mama = orangtua.fullname;
        papa = orangtua.partner;
      } else {
        mama = orangtua.partner;
        papa = orangtua.fullname;
      }

      $('#judul-anak').html(anak.fullname);
      $('#fullname').html(anak.fullname);
      $('#nickname').html(anak.nickname);
      $('#father').html(papa);
      $('#mother').html(mama);
      $('#seq').html(anak.seq);
      $('#gender').html(anak.gender);
      $('#born').html(anak.born);
      $('#dead').html(anak.dead);

      $('#partner').html(anak.partner);
      $('#partnerborn').html(anak.partnerborn);
      $('#partnerdead').html(anak.partnerdead);
      $('#child').html(anak.child);

      $("#modal-detail-info").modal("show");
    }

    // function untuk kembali ke table anak
    function backtableanak() {
      $('#table-anak').show();
      $('#table-putu').hide();
      $('#table-buyut').hide();
      $('#table-canggah').hide();

      $('#table-judul-anak').hide();
      $('#table-judul-putu').hide();
      $('#table-judul-buyut').hide();
    }

    // function untuk kembali ke table anak
    function backtableputu() {
      $('#table-putu').show();
      $('#table-buyut').hide();
      $('#table-canggah').hide();

      $('#table-judul-putu').hide();
      $('#table-judul-buyut').hide();
    }

    // function untuk kembali ke table anak
    function backtablebuyut() {
      $('#table-buyut').show();
      $('#table-canggah').hide();

      $('#table-judul-buyut').hide();
    }
  </script>
</body>

</html>